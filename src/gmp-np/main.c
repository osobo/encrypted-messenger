#include <stdio.h>
#include <gmp.h>

/*
const char* n_str =
"643808006803554439230129854961492699151386107534013432918073439524138264842370630061369715394739134090922937332590384720397133335969549256322620979036686633213903952966175107096769180017646161851573147596390153";
*/

/*
const char* r_str =
"84162174424773976115855838126082058648805436845170781751972494449099714468753293153818664580441415219631727501698851483408310916002940861810045036330430093599283578738055113571066620126149163476340692027772502016";

// Gives us np = 
// 7505123496202826225124156077202820851182876730714220596577571435857583973234367499107148620640593778647400330356644776218394558426888176246237795879355129610220194191946697309514054770295254812911038183537721543

*/

/*
const char* n_str =
"17125458317614137930196041979257577826408832324037508573393292981642667139747621778802438775238728592968344613589379932348475613503476932163166973813218698343816463289144185362912602522540494983090531497232965829536524507269848825658311420299335922295709743267508322525966773950394919257576842038771632742044142471053509850123605883815857162666917775193496157372656195558305727009891276006514000409365877218171388319923896309377791762590614311849642961380224851940460421710449368927252974870395873936387909672274883295377481008150475878590270591798350563488168080923804611822387520198054002990623911454389104774092183";
// Bit count = 2048 so r = 2^2048
const char* r_str =
"32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930385521914333389668342420684974786564569494856176035326322058077805659331026192708460314150258592864177116725943603718461857357598351152301645904403697613233287231227125684710820209725157101726931323469678542580656697935045997268352998638215525166389437335543602135433229604645318478604952148193555853611059596230656";
*/

const char* n_str =
"124325339146889384540494091085456630009856882741872806181731279018491820800119460022367403769795008250021191767583423221479185609066059226301250167164084041279837566626881119772675984258163062926954046545485368458404445166682380071370274810671501916789361956272226105723317679562001235501455748016154805420913";
// Bit count = 1024 so r = 2^1024
const char* r_str =
"179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137216";


int main()
{
  mpz_t n;
  mpz_t r;
  mpz_t n_inv;
  mpz_t np;

  mpz_init(n);
  mpz_init(r);
  mpz_init(n_inv);
  mpz_init(np);

  mpz_set_str(n, n_str, 10);
  mpz_set_str(r, r_str, 10);
  mpz_invert(n_inv, n, r);
  mpz_sub(np, r, n_inv);

  printf("n =\n%s\n\n", mpz_get_str(0, 10, n));
  printf("r =\n%s\n\n", mpz_get_str(0, 10, r));
  printf("n^-1 =\n%s\n\n", mpz_get_str(0, 10, n_inv));
  printf("np =\n%s\n\n", mpz_get_str(0, 10, np));
}
